document.addEventListener("DOMContentLoaded",()=>{const a=document.querySelector("form"),_=document.getElementById("username-label"),c=document.getElementById("username"),p=document.getElementById("password-label"),d=document.getElementById("password"),l=document.getElementById("non-field-errors"),i=document.getElementById("login-error"),m=document.getElementById("password-error"),u=document.getElementById("login-icon"),L=document.getElementById("password-icon"),g=(t,r,e,o)=>{o.classList.add("hidden"),t.classList.remove("error_label"),t.classList.add("correct_label"),r.classList.remove("error_input"),r.classList.add("correct_input"),e.classList.remove("error_icon"),e.classList.add("correct_icon")},n=(t,r,e,o,s)=>{o.textContent=s,o.classList.remove("hidden"),t.classList.add("error_label"),t.classList.remove("correct_label"),r.classList.add("error_input"),r.classList.remove("correct_input"),e.classList.add("error_icon"),e.classList.remove("correct_icon")};a.addEventListener("submit",async t=>{t.preventDefault(),g(_,c,u,i),g(p,d,L,m),l.classList.add("hidden");const r=new FormData(a);try{const e=await fetch(a.action,{method:"POST",body:r,headers:{"X-Requested-With":"XMLHttpRequest"}}),o=await e.json();if(e.ok)window.location.href=o.redirect_url;else{const s=o.errors;s.username&&n(_,c,u,i,s.username[0].message),s.password&&n(p,d,L,m,s.password[0].message),s.__all__&&(l.querySelector("p").textContent=s.__all__[0].message,l.classList.remove("hidden"),n(c,u,i,""),n(d,L,m,""))}}catch(e){console.error("Ошибка при отправке формы:",e)}})});
