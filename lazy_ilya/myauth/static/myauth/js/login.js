document.addEventListener("DOMContentLoaded",()=>{const g=document.querySelector("[name=csrfmiddlewaretoken]").value,c=document.querySelector("form"),p=document.getElementById("non-field-errors"),a=document.getElementById("username-label"),d=document.getElementById("username"),l=document.getElementById("password-label"),i=document.getElementById("password"),m=document.getElementById("login-error"),u=document.getElementById("password-error"),L=document.getElementById("login-icon"),_=document.getElementById("password-icon"),w=(t,r,e,o)=>{o.classList.add("hidden"),t.classList.remove("error_label"),t.classList.add("correct_label"),r.classList.remove("error_input"),r.classList.add("correct_input"),e.classList.remove("error_icon"),e.classList.add("correct_icon")},n=(t,r,e,o,s)=>{o.textContent=s,o.classList.remove("hidden"),t.classList.add("error_label"),t.classList.remove("correct_label"),r.classList.add("error_input"),r.classList.remove("correct_input"),e.classList.add("error_icon"),e.classList.remove("correct_icon")};c.addEventListener("submit",async t=>{t.preventDefault(),w(a,d,L,m),w(l,i,_,u);const r=new FormData(c);try{const e=await fetch(c.action,{method:"POST",body:r,headers:{"X-CSRFToken":g,"X-Requested-With":"XMLHttpRequest"}}),o=await e.json();if(e.ok)window.location.href=o.redirect_url;else{const s=o.errors;s.username&&n(a,d,L,m,s.username[0].message),s.password&&n(l,i,_,u,s.password[0].message),s.__all__&&(p.querySelector("p").textContent=s.__all__[0].message,p.classList.remove("hidden"),n(a,d,L,m,""),n(l,i,_,u,""))}}catch(e){console.error("Ошибка при отправке формы:",e)}})});
